!function(i){var n={};function s(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=i,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}({"./src/assets.ts":function(t,e,i){"use strict";function n(t){return{bitmap:null,wallType:t}}Object.defineProperty(e,"__esModule",{value:!0});var s={FOLDER_URL:"./assets/",MAP_BITMAP:void 0,TEXTURES:{map:n(),"wall-1":n(1),"wall-2":n(2),"wall-3":n(3),"wall-4":n(4),"wall-5":n(5),"wall-6":n(6),skybox:n(),npc:n(),gun:n(),explosion:n(),corpse:n(),"daemon-1":n(),"daemon-2":n(),"daemon-3":n(),"daemon-4":n()},SOUNDS:{}};e.default=s},"./src/config.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={DEBUG:!0,FOG:!0,FOG_COLOR:new(i("./src/engine/math/color.ts").default)(0,0,0),FOG_FACTOR:1,LIGHTING_FAKE_CONTRAST:!0,NPC_SPAWN_CHANGE:.01};e.default=n},"./src/engine/level.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("./src/assets.ts"),d=i("./src/engine/math/color.ts"),u=i("./src/game/walls-data.ts"),s={};e.WALL_TEXTURE=s,Object.values(n.default.TEXTURES).forEach(function(t){t.wallType&&(s[t.wallType]=t)});var o=(a.isWallTypeVoidOrAir=function(t){return-1===t||0===t},a.prototype.update=function(){this.sprites.forEach(function(t){t.collisionWith=null,t.detectCollisions()}),this.npcs.forEach(function(t){return t.update()})},a.prototype.getWallType=function(t){var e=Math.round(t.x),i=Math.round(t.y);if(e<0||e>this.size-1||i<0||i>this.size-1)return-1;var n=this.walls[i*this.size+e];return null==n?-1:n},a.prototype.isCollision=function(t){return!a.isWallTypeVoidOrAir(this.getWallType(t))},a.prototype.isNotCollision=function(t){return a.isWallTypeVoidOrAir(this.getWallType(t))},a.prototype.randomize=function(){for(var t=0;t<this.size*this.size;t++){var e=Math.floor(7*Math.random()+0),i=this.size/2;(.1<Math.random()||t===i*this.size+i)&&(e=0),this.walls[t]=e}},a.prototype.parseFromBitmap=function(r){for(var l=[],h=0;h<r.height;h++)for(var t=function(t){var e=h*(4*r.width)+4*t,i=r.imageData[e],n=r.imageData[1+e],s=r.imageData[2+e],o=r.imageData[3+e],a=new d.default(i,n,s,o);u.WALLS_DATA.forEach(function(t){t.color.equals(a)&&l.push(t.code)})},e=0;e<r.width;e++)t(e);this.size=r.width,this.walls=new Uint8Array(l)},a);function a(t,e,i,n,s){void 0===e&&(e=new Uint8Array(t*t)),void 0===i&&(i=[]),void 0===s&&(s=!1),this.size=t,this.walls=e,this.sprites=[],this.npcs=i,this.skybox=n,s&&this.randomize()}e.default=o},"./src/engine/math/angle.ts":function(t,e,i){"use strict";var n,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=n=n||{}).PI_2=2*Math.PI,o.UP=Math.PI/2,o.DOWN=3*Math.PI/2,o.LEFT=Math.PI,o.RIGHT=0,o.NORTH=o.UP,o.SOUTH=o.DOWN,o.WEST=o.LEFT,o.EAST=o.RIGHT,o.rad2deg=function(t){return t*(180/Math.PI)},o.deg2rad=function(t){return t*(Math.PI/180)},o.normalize=function(t){return t-o.PI_2*Math.floor(t/o.PI_2)},o.difference=function(t,e){var i=Math.abs(t-e)%o.PI_2;return i>Math.PI?o.PI_2-i:i},o.closestCardinal=function(t){var e=o.difference(t,o.LEFT),i=o.difference(t,o.RIGHT),n=o.difference(t,o.UP),s=o.difference(t,o.DOWN);return e<=i&&e<=n&&e<=s?o.LEFT:i<=n&&i<=s?o.RIGHT:n<=s?o.UP:o.DOWN},o.closestHorizontalCardinal=function(t){return o.difference(t,o.LEFT)<o.difference(t,o.RIGHT)?o.LEFT:o.RIGHT},o.closestVerticalCardinal=function(t){return o.difference(t,o.UP)<o.difference(t,o.DOWN)?o.UP:o.DOWN},o.betweenTwoPoints=function(t,e){return o.normalize(Math.atan2(e.y-t.y,e.x-t.x))},e.default=n},"./src/engine/math/color.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(s.prototype.equals=function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},s.prototype.getRGBAString=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a/255+")"},s);function s(t,e,i,n){void 0===n&&(n=255),this.r=t,this.g=e,this.b=i,this.a=n}e.default=n},"./src/engine/math/vector2.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(Object.defineProperty(s.prototype,"width",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!0,configurable:!0}),s.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},s.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},s.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},s.prototype.mult=function(t){return this.x*=t.x,this.y*=t.y,this},s.prototype.div=function(t){return this.x/=t.x,this.y/=t.y,this},s.prototype.neg=function(){return this.x*=-1,this.y*=-1,this},s.prototype.copy=function(){return new s(this.x,this.y)},s);function s(t,e){this.x=t,this.y=e}e.default=n},"./src/engine/platform/canvas.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canvas=document.querySelector("#render-output"),e.context=e.canvas.getContext("2d")},"./src/engine/platform/keyboard.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={keyCodes:[],alt:!1,ctrl:!1,meta:!1,shift:!1};e.default=n;var s=[];function o(t){n.keyCodes.includes(t.keyCode)||n.keyCodes.push(t.keyCode),n.alt=t.altKey,n.ctrl=t.ctrlKey,n.meta=t.metaKey,n.shift=t.shiftKey}function a(t){n.keyCodes.splice(n.keyCodes.indexOf(t.keyCode),1),n.alt=t.altKey,n.ctrl=t.ctrlKey,n.meta=t.metaKey,n.shift=t.shiftKey}e.keyboardListeners=s,e.initKeyboard=function(){window.addEventListener("keydown",o),window.addEventListener("keyup",a)},e.addKeyboardListener=function(t){s.push(t)}},"./src/engine/platform/mouse.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={movementX:0,movementY:0};e.default=n;var s=[];function o(t){n.movementX=t.movementX,n.movementY=t.movementY}e.mouseListeners=s,e.initMouse=function(){window.addEventListener("mousemove",o)},e.addMouseListener=function(t){s.push(t)},e.clearMouse=function(){n.movementX=0,n.movementY=0}},"./src/engine/platform/resize.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("./src/engine/platform/canvas.ts");e.default=function(t,e){t.width=window.innerWidth,t.height=window.innerHeight,n.context.imageSmoothingEnabled=!1,e.resize()}},"./src/engine/render/bitmap.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(s.prototype.getImageData=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=this.width,t.height=this.height,e.drawImage(this.image,0,0);var i=e.getImageData(0,0,this.width,this.height);return t.remove(),i.data},s);function s(t){this.image=t,this.width=this.image.naturalWidth,this.height=this.image.naturalHeight,this.imageData=this.getImageData()}e.default=n},"./src/engine/render/camera.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=i("./src/config.ts"),a=i("./src/assets.ts"),p=i("./src/engine/math/vector2.ts"),c=i("./src/engine/math/angle.ts"),m=i("./src/engine/math/color.ts"),y=i("./src/engine/render/gl.ts"),w=i("./src/engine/level.ts"),n=i("./src/engine/platform/canvas.ts"),s=(o.prototype.render=function(){this.castRays(),this.zBuffer=new Float32Array(this.ww),this.renderGround(),this.renderSkybox(),this.renderWalls(),this.renderNPCs(),this.renderGun(),this.postProcess()},o.prototype.renderGun=function(){var t=a.default.TEXTURES.gun.bitmap;this.gunOffset-=20,this.gunOffset<0&&(this.gunOffset=0);var e=Date.now(),i=this.ww/3.5,n=i,s=this.ww+50-i+this.heightOffset/2.5-this.gunOffset+15*Math.cos(e/500),o=this.wh+50-n+1*this.heightOffset-this.gunOffset+20*Math.cos(e/500);y.default.drawImage(t,new p.default(0,0),new p.default(t.width,t.height),new p.default(s,o),new p.default(i,n),Math.PI/(16-5*Math.cos(e/500)))},o.prototype.postProcess=function(){var t=255-this.level.player.health/100*255;y.default.drawRect(new p.default(0,0),new p.default(this.ww,this.wh),new m.default(160*Math.random(),0,0,4*t))},o.prototype.resize=function(){this.ww=n.canvas.width,this.wh=n.canvas.height,this.rayWidth=this.ww/this.rays.length,this.zBuffer=new Float32Array(this.ww)},o.prototype.castRays=function(){this.rays=[];for(var t=0;t<this.raysCount;t++){for(var e=-1,i=void 0,n=-1,s=c.default.normalize(this.rotation-this.fov/2+this.fov*t/this.raysCount),o=new p.default(this.position.x,this.position.y),a=new p.default(o.x,o.y),r=0;r<this.rayDistance;r+=this.rayStep){if(a.x=o.x+r*Math.cos(s),n=this.level.getWallType(a),!w.default.isWallTypeVoidOrAir(n)){e=r,i=o.x<a.x?2:3;break}if(a.y=o.y+r*Math.sin(s),n=this.level.getWallType(a),!w.default.isWallTypeVoidOrAir(n)){e=r,i=o.y<a.y?0:1;break}}-1!==e&&(e*=Math.cos(s-this.rotation)),this.rays.push({a:o,b:a,distance:e,rotation:s,side:i,type:n,index:t})}},o.prototype.fillWallStripeZBuffer=function(t){for(var e=Math.ceil(this.rayWidth*t.index),i=this.rayWidth*(t.index+1),n=e;n<i;n++)this.zBuffer[n]=t.distance},o.prototype.renderWalls=function(){for(var t=0;t<this.rays.length;t++)this.renderWallStripe(this.rays[t])},o.prototype.renderWallStripe=function(t){if(this.fillWallStripeZBuffer(t),-1!==t.distance){var e,i=w.WALL_TEXTURE[t.type].bitmap,n=(t.rotation,this.wh/t.distance),s=t.distance/this.rayDistance,o=this.wh/2-n/2+this.heightOffset,a=t.b.x%1,r=t.b.y%1;switch(t.side){case 0:e=1-a;break;case 3:e=1-r;break;case 1:e=a;break;case 2:e=r}e=.5<=e?e-.5:e+.5;var l=Math.floor(i.width*e);y.default.drawImage(i,new p.default(l,0),new p.default(1,i.height),new p.default(this.rayWidth*t.index,o),new p.default(this.rayWidth,n));var h=Math.floor(this.rayWidth*t.index),d=this.rayWidth*(t.index+1),u=Math.floor(d-h);if(f.default.LIGHTING_FAKE_CONTRAST&&(2===t.side||3===t.side)){var c=new m.default(0,0,0,128);y.default.drawRect(new p.default(h,o),new p.default(u,n),c)}f.default.FOG&&((c=f.default.FOG_COLOR).a=255*s*f.default.FOG_FACTOR,y.default.drawRect(new p.default(h,o),new p.default(u,n),c))}},o.prototype.renderNPC=function(t){var e=c.default.betweenTwoPoints(this.position,t.position),i=p.default.distance(this.position,t.position);if(!(i>this.rayDistance)){i<this.minSpriteDistance&&(i=this.minSpriteDistance);var n=this.wh/i,s=this.wh/i,o=e-this.rotation;1<o?o-=c.default.PI_2:o<-1&&(o+=c.default.PI_2);for(var a=o*this.ww/this.fov+this.ww/2-n/2,r=a+n,l=this.wh/2-s/2+this.heightOffset,h=a;h<r;h+=this.rayWidth){var d=this.zBuffer[Math.ceil(h)];if(!(null!=d&&d<i&&-1!==d)){var u=t.frame*t.frameWidth+Math.floor((h-a)*t.frameWidth/n);y.default.drawImage(t.bitmap,new p.default(u,0),new p.default(1,t.bitmap.height),new p.default(h,l),new p.default(this.rayWidth,s))}}}},o.prototype.renderNPCs=function(){this.sortSprites();for(var t=0;t<this.level.npcs.length;t++)this.renderNPC(this.level.npcs[t])},o.prototype.sortSprites=function(){var i=this;this.level.sprites.sort(function(t,e){return p.default.distance(i.position,e.position)-p.default.distance(i.position,t.position)})},o.prototype.renderGround=function(){y.default.drawRect(new p.default(0,0),new p.default(this.ww,this.wh),new m.default(0,0,0))},o.prototype.renderSkybox=function(){var t=this.level.skybox,e=t.width*(this.wh/t.height)*2,i=this.wh/2+this.heightOffset,n=this.rotation/Math.PI/2*-e;y.default.drawImage(t,new p.default(0,0),new p.default(t.width,t.height),new p.default(n,0),new p.default(e,i)),n<e-this.ww&&y.default.drawImage(t,new p.default(0,0),new p.default(t.width,t.height),new p.default(n+e,0),new p.default(e,i)),y.default.drawRect(new p.default(0,0),new p.default(this.ww,i),new m.default(0,0,0,256*Math.random()))},o.prototype.renderZBuffer=function(){for(var t=0;t<this.zBuffer.length;t++)if(-1!==this.zBuffer[t]){var e=this.zBuffer[t]/this.rayDistance,i=255*e;y.default.drawLine(new p.default(t,this.wh/2+this.heightOffset-15/e),new p.default(t,this.wh/2+this.heightOffset+15/e),new m.default(i,i,i))}},o);function o(t,e){void 0===e&&(e=Math.PI/2),this.position=new p.default(0,0),this.heightOffset=0,this.rotation=0,this.minSpriteDistance=.01,this.rays=[],this.rayDistance=15,this.rayStep=.01,this.raysCount=128,this.gunOffset=0,this.level=t,this.fov=e,this.resize(),f.default.RENDER_DEBUG_WALL_SIDES_TEXTURES&&(this.nBitmap=a.default.TEXTURES.n.bitmap,this.eBitmap=a.default.TEXTURES.e.bitmap,this.sBitmap=a.default.TEXTURES.s.bitmap,this.wBitmap=a.default.TEXTURES.w.bitmap)}e.default=s},"./src/engine/render/gl.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s,l=i("./src/engine/platform/canvas.ts"),a=i("./src/engine/math/color.ts");function r(t,e,i,n){void 0===n&&(n=0),l.context.save(),l.context.beginPath();var s=t.x+e.width/2,o=t.y+e.height/2;l.context.translate(s,o),l.context.rotate(n),i instanceof a.default&&(i=i.getRGBAString()),l.context.fillStyle=i,l.context.fillRect(-e.width/2,-e.height/2,e.width,e.height),l.context.closePath(),l.context.restore()}(s=n=n||{}).drawRect=r,s.drawImage=function(t,e,i,n,s,o){void 0===o&&(o=0),l.context.save();var a=n.x+s.width/2,r=n.y+s.height/2;l.context.translate(a,r),l.context.rotate(o),l.context.translate(-a,-r),l.context.drawImage(t.image,e.x,e.y,i.width,i.height,n.x,n.y,s.width,s.height),l.context.restore()},s.drawGradient=function(t,e,i){for(var n=[],s=3;s<arguments.length;s++)n[s-3]=arguments[s];for(var o=l.context.createLinearGradient(0,0,0,e.height),a=0;a<n.length;a++)o.addColorStop(a,n[a].getRGBAString());r(t,e,o,i)},s.drawLine=function(t,e,i){l.context.save(),l.context.beginPath(),l.context.strokeStyle=i.getRGBAString(),l.context.moveTo(t.x,t.y),l.context.lineTo(e.x,e.y),l.context.stroke(),l.context.closePath(),l.context.restore()},s.clear=function(){l.context.clearRect(0,0,l.canvas.width,l.canvas.height)},e.default=n},"./src/engine/render/sprite.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("./src/engine/math/vector2.ts"),s=(o.prototype.detectCollisions=function(){n.default.distance(this.position,this.level.player.position)<=this.collisionTriggerDistance&&this.onCollision(this.level.player)},o.prototype.onCollision=function(t){this.collisionWith=t},o);function o(t,e,i){this.collisionTriggerDistance=1,this.bitmap=t,this.position=e,this.level=i,this.level.sprites.push(this)}e.default=s},"./src/engine/tick.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("./src/engine/render/gl.ts"),s=i("./src/engine/platform/keyboard.ts"),o=i("./src/engine/platform/mouse.ts");e.default=function t(e){s.keyboardListeners.forEach(function(t){return t()}),o.mouseListeners.forEach(function(t){return t()}),o.clearMouse(),n.default.clear(),e(),requestAnimationFrame(t.bind(this,e))}},"./src/game/npc.ts":function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("./src/assets.ts"),a=i("./src/engine/math/vector2.ts"),r=i("./src/engine/render/sprite.ts"),l=i("./src/engine/level.ts");window.kills=0;var h,d=(h=r.default,s(u,h),u.prototype.update=function(){var t=this.position.copy(),e=new a.default(this.moveSpeed,this.moveSpeed),i=t.sub(this.level.player.position).mult(e),n=new a.default(this.position.x-i.x,this.position.y-i.y),s=this.level.getWallType(n);this.corpse||(l.default.isWallTypeVoidOrAir(s)?this.position.sub(i):this.position.add(i)),.65<Math.random()&&this.frame++,this.frame>=this.framesCount&&(this.destroyed?(this.bitmap=o.default.TEXTURES.corpse.bitmap,this.frame=0,this.framesCount=8,this.frameWidth=51,this.corpse=!0):this.frame=0)},u.prototype.destroy=function(t){void 0===t&&(t=!1),this.destroyed=!0,this.bitmap=o.default.TEXTURES.explosion.bitmap,this.frame=0,this.framesCount=6,this.frameWidth=32;var e=Math.floor(7*Math.random()+1);if(!t||t&&Math.random()<.05){var i=window.sound.play("scream"+e);window.sound.volume(.5,i),window.sound.fade(.85,1,.15*window.sound.duration(i),i)}t||(window.kills++,document.querySelector("#count").textContent=window.kills)},u.prototype.onCollision=function(t){this.collisionWith=t,this.corpse||this.destroyed||(this.level.player.health-=2)},u);function u(t,e,i,n,s){var o=h.call(this,t,e,i)||this;return o.frame=0,o.framesCount=0,o.frameWidth=0,o.destroyed=!1,o.corpse=!1,o.moveSpeed=.0085,o.framesCount=n,o.frameWidth=s,o.level.npcs.push(o),o}e.default=d},"./src/game/player.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("./src/engine/math/vector2.ts"),l=i("./src/engine/math/angle.ts"),n=i("./src/engine/platform/keyboard.ts"),s=i("./src/engine/platform/mouse.ts"),o=(a.prototype.update=function(){this.nullifyHeightOffset(),this.isMoving=!1,this.health+=1,100<this.health&&(this.health=100),this.health<0&&window.restart()},a.prototype.move=function(t){var e,i,n,s,o=this.position,a=performance.now();switch(this.isMoving=!0,t){case 0:e=this.moveSpeed*Math.cos(this.rotation),i=this.moveSpeed*Math.sin(this.rotation),n=this.level.isNotCollision(new r.default(o.x+e,o.y)),s=this.level.isNotCollision(new r.default(o.x,o.y+i)),n&&(this.position.x+=e),s&&(this.position.y+=i),n&&s&&(this.camera.heightOffset-=Math.cos(a/this.noddlingFrequency)*this.noddlingForce);break;case 2:this.rotation-=this.rotateSpeed;break;case 1:e=this.moveSpeed*Math.cos(this.rotation),i=this.moveSpeed*Math.sin(this.rotation),n=this.level.isNotCollision(new r.default(o.x-e,o.y)),s=this.level.isNotCollision(new r.default(o.x,o.y-i)),n&&(this.position.x-=e),s&&(this.position.y-=i),n&&s&&(this.camera.heightOffset+=Math.cos(a/this.noddlingFrequency)*this.noddlingForce);break;case 3:this.rotation+=this.rotateSpeed}this.rotation=l.default.normalize(this.rotation),this.camera.position=this.position,this.camera.rotation=this.rotation},a.prototype.onKeyboardTick=function(){(n.default.keyCodes.includes(38)||n.default.keyCodes.includes(87))&&this.move(0),(n.default.keyCodes.includes(37)||n.default.keyCodes.includes(65))&&this.move(2),(n.default.keyCodes.includes(40)||n.default.keyCodes.includes(83))&&this.move(1),(n.default.keyCodes.includes(39)||n.default.keyCodes.includes(68))&&this.move(3)},a.prototype.onMouseTick=function(){0<s.default.movementX?this.move(3):s.default.movementX<0&&this.move(2)},a.prototype.attack=function(){this.camera.gunOffset=200;for(var t=0;t<this.level.npcs.length;t++){var e=this.level.npcs[t];if(r.default.distance(this.position,e.position)<1&&!e.corpse&&!e.destroyed){e.destroy();break}}},a.prototype.nullifyHeightOffset=function(){this.isMoving||(this.camera.heightOffset=Math.trunc(this.camera.heightOffset),this.camera.heightOffset>this.noddlingStabilizationSpeed?this.camera.heightOffset-=this.noddlingStabilizationSpeed:this.camera.heightOffset<-this.noddlingStabilizationSpeed&&(this.camera.heightOffset+=this.noddlingStabilizationSpeed))},a);function a(t,e,i,n){void 0===i&&(i=new r.default(0,0)),void 0===n&&(n=0),this.rotation=0,this.health=100,this.moveSpeed=.1,this.rotateSpeed=Math.PI/64,this.noddlingStabilizationSpeed=20,this.noddlingFrequency=120,this.noddlingForce=5,this.isMoving=!1,this.camera=t,this.level=e,this.position=i,this.rotation=n}e.default=o},"./src/game/walls-data.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("./src/engine/math/color.ts"),s=[{name:"air",code:0,color:new n.default(0,0,0,0)},{name:"wall-1",code:1,color:new n.default(0,0,0,255)},{name:"wall-2",code:2,color:new n.default(255,0,0,255)},{name:"wall-3",code:3,color:new n.default(255,0,0,255)},{name:"wall-4",code:4,color:new n.default(255,0,0,255)},{name:"wall-5",code:5,color:new n.default(255,0,0,255)},{name:"wall-6",code:6,color:new n.default(255,0,0,255)}];e.WALLS_DATA=s},"./src/izdelie-27.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o,s,a,r,l,h=i("./src/config.ts"),d=i("./src/assets.ts"),u=i("./src/engine/tick.ts"),c=i("./src/engine/platform/resize.ts"),f=i("./src/engine/platform/canvas.ts"),p=i("./src/engine/platform/keyboard.ts"),m=i("./src/engine/platform/mouse.ts"),y=i("./src/engine/math/vector2.ts"),w=i("./src/engine/render/camera.ts"),v=i("./src/engine/level.ts"),g=i("./src/game/player.ts"),b=i("./src/engine/render/bitmap.ts"),M=i("./src/game/npc.ts");function T(){l.randomize(),r.position.x=l.size/2,r.position.y=l.size/2,a.position=r.position,a.rotation=r.rotation,window.sound.seek(0,s),l.npcs.forEach(function(t){t.destroy(!0)}),l.npcs.length=Math.floor(Math.random()*l.sprites.length),l.sprites.length=0,setTimeout(function(){window.kills=0,document.querySelector("#count").textContent=window.kills},2500)}n=function(){d.default.MAP_BITMAP=d.default.TEXTURES.map.bitmap,(l=new v.default(0,null,[],d.default.TEXTURES.skybox.bitmap,!1)).parseFromBitmap(d.default.MAP_BITMAP),l.randomize(),a=new w.default(l),r=new g.default(a,l,new y.default(l.size/2,l.size/2),Math.PI/-2),a.position=r.position,a.rotation=r.rotation,l.player=r,p.initKeyboard(),p.addKeyboardListener(r.onKeyboardTick.bind(r)),m.initMouse(),u.default(function(){a.render(),r.update(),l.update();var t=1+50*(1-r.health/100);window.sound.volume(t,s),a.fov+=Math.cos(Date.now()/400)/175,Math.random()<h.default.NPC_SPAWN_CHANGE&&function(t){switch(Math.floor(4*Math.random()+0)){case 0:return new M.default(d.default.TEXTURES["daemon-1"].bitmap,new y.default(Math.ceil(t.size*Math.random()),Math.ceil(t.size*Math.random())),t,1,64);case 1:return new M.default(d.default.TEXTURES["daemon-2"].bitmap,new y.default(Math.ceil(t.size*Math.random()),Math.ceil(t.size*Math.random())),t,1,64);case 2:return new M.default(d.default.TEXTURES["daemon-3"].bitmap,new y.default(Math.ceil(t.size*Math.random()),Math.ceil(t.size*Math.random())),t,10,200);case 3:new M.default(d.default.TEXTURES["daemon-4"].bitmap,new y.default(Math.ceil(t.size*Math.random()),Math.ceil(t.size*Math.random())),t,4,48)}}(l)}),setInterval(function(){h.default.NPC_SPAWN_CHANGE*=1.25},15e3),window.addEventListener("resize",c.default.bind(this,f.canvas,a)),window.addEventListener("keyup",function(t){switch(t.keyCode){case 32:r.attack();break;case 82:T()}}),c.default(f.canvas,a)},o=[],Object.keys(d.default.TEXTURES).forEach(function(s){o.push(new Promise(function(t,e){var i=""+d.default.FOLDER_URL+s+".png",n=new Image;n.addEventListener("load",function(){d.default.TEXTURES[s].bitmap=new b.default(n),t(n)}),n.addEventListener("error",function(){e(new Error("Не получилось загрузить картинку: "+i))}),n.src=""+d.default.FOLDER_URL+s+".png"}))}),Promise.all(o).then(n),window.sound=new window.Howl({src:["./assets/sound.mp3"],sprite:{scream1:[0,760],scream2:[1160,560],scream3:[2240,2800],scream4:[5520,2320],scream5:[8440,3e3],scream6:[12040,3920],scream7:[16640,1400],music:[19190,739880,!0]},volume:1}),s=window.sound.play("music"),window.restart=T,setTimeout(function(){document.querySelector("#author").style.display="none",document.querySelector("#title").style.display="block"},4e3),setTimeout(function(){document.querySelector("#title").style.display="none",document.querySelector("#manual").style.display="block"},8e3),setTimeout(function(){document.querySelector("#manual").style.display="none",document.querySelector("#text").style.display="none"},17e3)},0:function(t,e,i){t.exports=i("./src/izdelie-27.ts")}});